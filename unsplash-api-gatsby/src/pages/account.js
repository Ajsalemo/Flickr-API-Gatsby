// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //
// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //

import React, { Fragment, useEffect } from "react"
import { StyledMainContainer } from "../helpers/styledcomponents"
import { getProfile, isAuthenticated, login } from "../utils/auth"
import firebase from "../utils/firebase"

// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //
// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //

const Account = () => {
  useEffect(() => {
    if (!isAuthenticated()) {
      login()
      return <p>Redirecting to login...</p>
    }
    const user = getProfile()
    const db = firebase.firestore().collection("users").doc(user.name)

    db.get()
      .then(doc => {
        if (doc.exists) {
          const documentResult = doc.data()
          for (const property in documentResult) {
            console.log(`${property}: ${documentResult[property]}`)
          }
        } else {
          console.log("No document")
        }
      })
      .catch(err => console.log(err))
  }, [])

  return (
    <Fragment>
      <StyledMainContainer container>
        <p>This is going to be a protected route.</p>
      </StyledMainContainer>
    </Fragment>
  )
}

// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //
// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //

export default Account

// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //
// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- //
